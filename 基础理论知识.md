###基础理论知识

#### 衡量的指标
+ 性能
	+ 吞吐能力 以及 响应时间
+ 一致性
	+ 特性：越是强的一致性模型，用户使用起来会越发简单.
+ 可用性
	+ 系统在面对各种异常时仍可以提供正常的服务.
+ 可扩展性
	+ 分布式系统可以通过扩展集群服务器的规模来提高系统的性能(storage、compute、perform).
+ 一致性 和 可用性 是矛盾的。
		+ 强同步复制协议可以保证主备副本之间的一致性，但当备副本出现故障时，也可能阻塞系统的正常的读写.

#### 异常
##### 异常类型
+ 服务器宕机
+ 网路异常
+ 磁盘故障

### 数据分布
+ 哈希分布
	+ 破坏了数据的有序性. 
	+ 一致性哈希分布，case sys: Amazon 和 Dynamo系统
	+ 问题：[数据倾斜 - 如何定制哈希函数]
+ 顺序分布式
	+ 根据表的主键把表分成多个字表。case: Google'BigTable. 
	+ 类似B+树
+ 因素
	+ 数据均匀（Load值、CPU、内存、磁盘以及网路）

### 数据复制
+ 主备复制
	+ 需要选主、通过日志. 
		+ 数据需要在系统中保存多个副本，从而保证了系统的可靠性和可用性。
		+ 存在多个副本，其中一个为主副本，其他为备副本.
		+ 强同步复制，主副本在备副本操作成功后，操作本地，最后通知客户端操作结果（主备成功才写成功）.
		+ 异步复制，主副本不需要等待备副本结果，本地操作后，返回结果.

### 故障
+ 故障检测
	+ 租约机制（授权）
	+ worker和master需要同步时间.
	+ worker向master申请lease.
	+ woker在lease有效期内才能提供服务.
	+ woker通过不断申请lease来延长有效期. 
+ 故障恢复
	+ ![avatar](https://github.com/tjlcast/Note_LargeScale_Distributed_System/blob/master/imgs/%E6%95%85%E9%9A%9C%E6%81%A2%E5%A4%8D.png)
	+ 当worker出现问题时，master首先需要选择一个最新的副本.作为新的主副本提供写服务.
	+ 如果是永久故障（超过时间）,需要将服务迁移到其他worker上.


